services:
  account-service:
    build: ./AccountService
    container_name: account-service
    environment:
      - KEY=1234
    ports:
      - "5003:5003"

  rental-service:
    build: ./RentalService
    container_name: rental-service
    environment:
      - KEY=1234
    ports:
      - "5001:5001"

  inspection_service:
    build:
      context: ./InspectionService # Antager du har en Dockerfile i denne mappe
    container_name: inspection_service
    ports:
      # Host port 5003 -> Container port 5003
      - "5005:5005"
    environment:
      # Kan bruges til at s√¶tte DATABASE_URL, hvis du skifter fra SQLite
      - FLASK_ENV=development

  return-service:
    build:
      context: ./returnservice
    container_name: return-service
    ports:
      - "5002:5002"
    environment:
      - FLASK_ENV=development
      - KEY=1234
      # Du kan her definere DATABASE_URL, hvis du vil overskrive "sqlite:///./returnservice_local.db"
      # - DATABASE_URL=...


  api-gateway:
    build:
      context: ./ApiGateway
    container_name: api-gateway
    ports:
      - "5000:5000"
    depends_on:
      - rental-service
      - inspection_service
      - return-service
      
    environment:
      - RENTAL_SERVICE_URL=http://rental_service:5001
      - INSPECTION_SERVICE_URL=http://inspection_service:5005
      - RETURN_SERVICE_URL=http://return-service:5002
      - ACCOUNT_SERVICE_URL=http://account-service:5003
      - DAMAGE_SERVICE_URL=http://damage-service:5004
  
  ui_service:
    build:
      context: ./UIService
    container_name: ui-service
    ports:
      - "8501:8501"
    depends_on:
      - api-gateway
      - rental-service
      - return-service
    environment:
      - API_GATEWAY_URL=http://api-gateway:5000/api

  damage-service:
    build: ./DamageService
    container_name: damage-service
    environment:
      - KEY=1234
    ports:
      - "5004:5004"
