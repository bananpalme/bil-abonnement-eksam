services:
  account-service:
    build: ./AccountService
    container_name: account-service
    environment:
      - KEY=1234
    ports:
      - "5003:5003"

  rental-service:
    build: ./RentalService
    container_name: rental-service
    environment:
      - KEY=1234
    ports:
      - "5001:5001"

  return_service:
    build:
      context: ./returnservice
    container_name: return_service
    # Host port 5002 -> Container port 5000 (Flask default)
    ports:
      - "5002:5002"
    # Fjernede depends_on: rental_service (un√∏dvendigt)
    # Sikrer persistens for SQLite-filen i Return Service
   
    environment:
      - FLASK_ENV=development
      # Du kan her definere DATABASE_URL, hvis du vil overskrive "sqlite:///./returnservice_local.db"
      # - DATABASE_URL=...


  api_gateway:
    build:
      context: ./ApiGateway
    container_name: api_gateway
    ports:
      - "5000:5000"
    depends_on:
      - rental_service
      - return_service
    environment:
      - RENTAL_SERVICE_URL=http://rental-service:5001
      - RETURN_SERVICE_URL=http://return-service:5002
      - ACCOUNT_SERVICE_URL=http://account-service:5003
      - DAMAGE_SERVICE_URL=http://damage-service:5004
  
  ui_service:
    build:
      context: ./UIService
    container_name: ui_service
    ports:
      - "8501:8501"
    depends_on:
      - api_gateway
      - rental_service
      - return_service
    environment:
      - API_GATEWAY_URL=http://api-gateway:5000/api

  damage-service:
    build: ./DamageService
    container_name: damage-service
    environment:
      - KEY=1234
    ports:
      - "5004:5004"
      - API_GATEWAY_URL=http://api_gateway:5000
